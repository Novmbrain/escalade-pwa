{
  "name": "escalade-pwa",
  "displayName": "罗源野抱 TOPO",
  "version": "0.1.0",
  "generated": "2026-01-26",
  "projectStats": {
    "sourceFiles": 146,
    "testFiles": 41,
    "testCoverage": 34,
    "components": 48,
    "apiRoutes": 11,
    "pages": 9,
    "hooks": 12,
    "languages": 3,
    "totalTests": 598
  },
  "techStack": {
    "framework": "Next.js 16.1.2 (App Router)",
    "runtime": "React 19.2.3",
    "database": "MongoDB 7.0.0",
    "styling": "Tailwind CSS 4.x",
    "pwa": "Serwist 9.5.0",
    "i18n": "next-intl 4.7.0",
    "testing": "Vitest 4.0.17 + Playwright 1.57.0"
  },
  "entryPoints": {
    "home": "src/app/[locale]/page.tsx",
    "homeClient": "src/app/[locale]/home-client.tsx",
    "cragDetail": "src/app/[locale]/crag/[id]/page.tsx",
    "cragDetailClient": "src/app/[locale]/crag/[id]/crag-detail-client.tsx",
    "routeList": "src/app/[locale]/route/page.tsx",
    "routeListClient": "src/app/[locale]/route/route-client.tsx",
    "routeDetail": "src/app/[locale]/route/[id]/page.tsx",
    "routeDetailClient": "src/app/[locale]/route/[id]/route-detail-client.tsx",
    "profile": "src/app/[locale]/profile/page.tsx",
    "offline": "src/app/[locale]/offline/page.tsx",
    "offlineCrag": "src/app/[locale]/offline/crag/[id]/page.tsx",
    "offlineRoute": "src/app/[locale]/offline/route/[id]/page.tsx",
    "demo": "src/app/[locale]/demo/page.tsx",
    "editor": "src/app/[locale]/editor/page.tsx",
    "serviceWorker": "src/app/sw.ts",
    "rootLayout": "src/app/layout.tsx",
    "localeLayout": "src/app/[locale]/layout.tsx"
  },
  "apiRoutes": {
    "beta": {
      "path": "src/app/api/beta/route.ts",
      "methods": ["GET", "POST"],
      "rateLimit": "POST 60 req/hour",
      "cache": "GET 1h"
    },
    "weather": {
      "path": "src/app/api/weather/route.ts",
      "methods": ["GET"],
      "cache": "1h"
    },
    "geo": {
      "path": "src/app/api/geo/route.ts",
      "methods": ["GET"],
      "cache": "7d"
    },
    "visit": {
      "path": "src/app/api/visit/route.ts",
      "methods": ["POST"]
    },
    "feedback": {
      "path": "src/app/api/feedback/route.ts",
      "methods": ["POST"],
      "rateLimit": "60 req/hour"
    },
    "log": {
      "path": "src/app/api/log/route.ts",
      "methods": ["POST"],
      "rateLimit": "100 req/hour"
    },
    "crags": {
      "path": "src/app/api/crags/route.ts",
      "methods": ["GET"],
      "cache": "ISR",
      "new": true
    },
    "cragRoutes": {
      "path": "src/app/api/crags/[id]/routes/route.ts",
      "methods": ["GET"],
      "cache": "ISR",
      "new": true
    },
    "routes": {
      "path": "src/app/api/routes/[id]/route.ts",
      "methods": ["GET", "PATCH"],
      "cache": "ISR",
      "new": true
    },
    "upload": {
      "path": "src/app/api/upload/route.ts",
      "methods": ["POST"],
      "rateLimit": "10 req/hour",
      "new": true
    }
  },
  "coreModules": {
    "database": {
      "path": "src/lib/db/index.ts",
      "exports": [
        "getAllCrags",
        "getCragById",
        "getAllRoutes",
        "getRouteById",
        "getRoutesByCragId",
        "updateRoute",
        "createFeedback",
        "recordVisit",
        "getVisitStats"
      ]
    },
    "mongodb": {
      "path": "src/lib/mongodb.ts",
      "exports": ["getDatabase"]
    },
    "themes": {
      "path": "src/lib/themes/",
      "exports": ["themes", "getTheme", "ThemeId"]
    },
    "logger": {
      "server": "src/lib/logger.ts",
      "client": "src/lib/client-logger.ts"
    },
    "weather": {
      "utils": "src/lib/weather-utils.ts",
      "constants": "src/lib/weather-constants.ts"
    },
    "offlineStorage": {
      "path": "src/lib/offline-storage.ts",
      "exports": ["OfflineStorage", "downloadCrag", "getCachedCrags", "clearCache"]
    },
    "topoUtils": {
      "path": "src/lib/topo-utils.ts",
      "exports": ["bezierCurve", "scalePoints", "normalizePoint", "generateRouteColor", "generateRouteId"],
      "new": true
    },
    "constants": {
      "path": "src/lib/constants.ts",
      "exports": ["IMAGE_VERSION", "getRouteTopoUrl", "getCragCoverUrl"],
      "new": true
    },
    "city": {
      "path": "src/lib/city-config.ts",
      "exports": ["CITIES", "CityId", "CityConfig"]
    },
    "cache": {
      "path": "src/lib/cache-config.ts",
      "exports": ["ISR_REVALIDATE", "SW_CACHE", "API_CACHE", "HTTP_CACHE"]
    },
    "rateLimit": {
      "path": "src/lib/rate-limit.ts",
      "exports": ["RateLimiter"]
    },
    "pinyin": {
      "path": "src/lib/pinyin-utils.ts",
      "exports": ["generateSearchPinyin", "searchByPinyin"]
    }
  },
  "components": {
    "ui": {
      "drawer": "src/components/ui/drawer.tsx",
      "imageViewer": "src/components/ui/image-viewer.tsx",
      "segmentedControl": "src/components/ui/segmented-control.tsx",
      "toast": "src/components/ui/toast.tsx",
      "button": "src/components/ui/button.tsx",
      "card": "src/components/ui/card.tsx",
      "skeleton": "src/components/ui/skeleton.tsx"
    },
    "business": {
      "cragCard": "src/components/crag-card.tsx",
      "weatherStrip": "src/components/weather-strip.tsx",
      "weatherCard": "src/components/weather-card.tsx",
      "weatherBadge": "src/components/weather-badge.tsx",
      "amapContainer": "src/components/amap-container.tsx",
      "filterDrawer": "src/components/filter-drawer.tsx",
      "filterChip": "src/components/filter-chip.tsx",
      "gradeRangeSelector": "src/components/grade-range-selector.tsx",
      "searchOverlay": "src/components/search-overlay.tsx",
      "searchDrawer": "src/components/search-drawer.tsx",
      "citySelector": "src/components/city-selector.tsx",
      "routeDetailDrawer": "src/components/route-detail-drawer.tsx",
      "betaListDrawer": "src/components/beta-list-drawer.tsx",
      "betaSubmitDrawer": "src/components/beta-submit-drawer.tsx",
      "localeSwitcher": "src/components/locale-switcher.tsx",
      "localeDetector": "src/components/locale-detector.tsx",
      "downloadButton": "src/components/download-button.tsx",
      "offlineIndicator": "src/components/offline-indicator.tsx",
      "offlineCacheManager": "src/components/offline-cache-manager.tsx",
      "offlineDownloadProvider": "src/components/offline-download-provider.tsx",
      "appTabbar": "src/components/app-tabbar.tsx",
      "themeSwitcher": "src/components/theme-switcher.tsx",
      "themeProvider": "src/components/theme-provider.tsx",
      "installPrompt": "src/components/install-prompt.tsx",
      "swUpdatePrompt": "src/components/sw-update-prompt.tsx"
    }
  },
  "hooks": {
    "useRouteSearch": "src/hooks/use-route-search.ts",
    "useCitySelection": "src/hooks/use-city-selection.ts",
    "useDelayedLoading": "src/hooks/use-delayed-loading.ts",
    "useLocalePreference": "src/hooks/use-locale-preference.ts",
    "useOfflineMode": "src/hooks/use-offline-mode.ts",
    "useOfflineDownload": "src/hooks/use-offline-download.ts",
    "useClimberBodyData": {
      "path": "src/hooks/use-climber-body-data.ts",
      "new": true
    }
  },
  "i18n": {
    "routing": "src/i18n/routing.ts",
    "request": "src/i18n/request.ts",
    "navigation": "src/i18n/navigation.ts",
    "middleware": "src/middleware.ts",
    "messages": {
      "zh": "messages/zh.json",
      "en": "messages/en.json",
      "fr": "messages/fr.json"
    },
    "languages": ["zh", "en", "fr"],
    "defaultLanguage": "zh"
  },
  "types": {
    "path": "src/types/index.ts",
    "exports": [
      "Route",
      "Crag",
      "Coordinates",
      "ApproachPath",
      "BetaLink",
      "BetaPlatform",
      "WeatherData",
      "WeatherLive",
      "WeatherForecast",
      "ClimbingCondition",
      "ClimbingSuitability",
      "Feedback",
      "VisitStats",
      "TopoPoint",
      "TopoData",
      "OfflineCragMeta",
      "DownloadProgress"
    ]
  },
  "offlineMode": {
    "enabled": true,
    "storage": "IndexedDB",
    "pages": [
      "src/app/[locale]/offline/page.tsx",
      "src/app/[locale]/offline/crag/[id]/page.tsx",
      "src/app/[locale]/offline/route/[id]/page.tsx"
    ],
    "features": [
      "Crag-level download",
      "Progress tracking",
      "Cache management",
      "Auto offline detection"
    ]
  },
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build --webpack",
    "start": "next start",
    "lint": "eslint",
    "test": "vitest",
    "test:run": "vitest run",
    "test:coverage": "vitest run --coverage",
    "test:ct": "playwright test -c playwright-ct.config.ts",
    "db:seed": "npx tsx scripts/seed.ts development",
    "db:seed:prod": "npx tsx scripts/seed.ts production"
  },
  "tests": {
    "framework": "Vitest + Playwright",
    "unitTests": 39,
    "componentTests": 2,
    "totalTests": 598,
    "coverage": 34,
    "ci": ["ESLint", "TypeScript", "Vitest", "Playwright"]
  },
  "environment": {
    "nodeVersion": "20.9.0+",
    "requiredEnvVars": ["MONGODB_URI", "NEXT_PUBLIC_AMAP_KEY"]
  },
  "cdn": {
    "imageDomain": "img.bouldering.top",
    "provider": "Cloudflare R2",
    "cache": "30 days"
  }
}
