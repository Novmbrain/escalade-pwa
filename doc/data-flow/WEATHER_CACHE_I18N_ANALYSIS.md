# å¤©æ°”æ¨¡å—ç¼“å­˜ä¸å›½é™…åŒ–é—®é¢˜åˆ†æ

> åˆ†ææ—¥æœŸ: 2026-02-12
> åˆ†æ”¯: fix/same-face-routes-not-updating

## 1. æ¶æ„æ¦‚è§ˆ

### 1.1 æ•°æ®æµ

```
é«˜å¾·å¤©æ°” API (ä¸­æ–‡)
    â†“
/api/weather (æœåŠ¡ç«¯)
    â”œâ”€â”€ é€†åœ°ç†ç¼–ç  (åæ ‡ â†’ adcode)
    â”œâ”€â”€ è·å–å®å†µ + é¢„æŠ¥ (ä¸¤æ¬¡å¹¶å‘è¯·æ±‚)
    â”œâ”€â”€ evaluateClimbingCondition() (ç”Ÿæˆä¸­æ–‡ label/description/factors)
    â””â”€â”€ å†…å­˜ç¼“å­˜ Map<adcode, WeatherData>  â† ç¬¬1å±‚ç¼“å­˜
    â†“
HTTP å“åº” (Cache-Control: public, max-age=3600)  â† ç¬¬2å±‚ç¼“å­˜
    â†“
SWR (dedupingInterval: 60000)  â† ç¬¬3å±‚ç¼“å­˜
    â†“
WeatherStrip / WeatherCard / WeatherBadge (å®¢æˆ·ç«¯æ¸²æŸ“)
```

### 1.2 ä¸‰å±‚ç¼“å­˜ç»“æ„

| å±‚çº§ | ä½ç½® | ç¼“å­˜ Key | TTL | ä½œç”¨ |
|------|------|---------|-----|------|
| L1 | æœåŠ¡ç«¯å†…å­˜ (`route.ts`) | `adcode` | 1 å°æ—¶ | é¿å…é‡å¤è°ƒç”¨é«˜å¾· API |
| L2 | æµè§ˆå™¨/CDN | URL | 1 å°æ—¶ (`max-age=3600`) | HTTP å±‚ç¼“å­˜ |
| L3 | å®¢æˆ·ç«¯ SWR (`use-weather.ts`) | `/api/weather?adcode=xxx` | 1 åˆ†é’Ÿå»é‡ | ç»„ä»¶é—´å…±äº« + è¯·æ±‚å»é‡ |

## 2. é—®é¢˜åˆ†æ

### 2.1 è¯­è¨€åˆ‡æ¢åå¤©æ°”æ¨¡å—è¯­è¨€æœªæ›´æ–°

**ç»“è®º: å­˜åœ¨éƒ¨åˆ†æœªå›½é™…åŒ–çš„ä¸­æ–‡æ–‡æœ¬ï¼Œä½† SWR ç¼“å­˜ä¸æ˜¯æ ¹å› ã€‚**

#### åŸå› åˆ†æ

é«˜å¾· API (`restapi.amap.com`) æ˜¯ä¸­æ–‡ APIï¼Œè¿”å›æ•°æ®**æ°¸è¿œæ˜¯ä¸­æ–‡**ï¼š

```json
{
  "weather": "æ™´",         // â† å§‹ç»ˆä¸­æ–‡
  "temperature": "18",
  "humidity": "65",
  "winddirection": "ä¸œåŒ—",  // â† å§‹ç»ˆä¸­æ–‡
  "windpower": "â‰¤3"
}
```

SWR çš„ç¼“å­˜ key æ˜¯ `/api/weather?adcode=350125`ï¼Œä¸åŒ…å« localeã€‚ä½†è¿™**ä¸æ˜¯é—®é¢˜**â€”â€”å› ä¸º API å“åº”æœ¬èº«ä¸ locale æ— å…³ï¼Œæ— è®ºå“ªç§è¯­è¨€è¯·æ±‚ï¼Œè¿”å›çš„éƒ½æ˜¯ç›¸åŒçš„ä¸­æ–‡åŸå§‹æ•°æ®ã€‚

çœŸæ­£çš„é—®é¢˜åœ¨äº**ç»„ä»¶å±‚å±•ç¤º**ã€‚

#### å„ç»„ä»¶å›½é™…åŒ–çŠ¶æ€

| ç»„ä»¶ | å­—æ®µ | æ¥æº | å½“å‰å¤„ç†æ–¹å¼ | çŠ¶æ€ |
|------|------|------|-------------|------|
| **WeatherStrip** | æ”€çˆ¬é€‚å®œåº¦æ ‡ç­¾ | `climbing.level` | `t(climbing.level)` â†’ "Excellent" | âœ… å·²å›½é™…åŒ– |
| **WeatherStrip** | å¤©æ°”æè¿° | `live.weather` | `t.has()` + å›é€€ | âœ… å·²ä¿®å¤ |
| **WeatherCard** | æ ‡é¢˜ | - | `t('liveWeather')` â†’ "Live Weather" | âœ… å·²å›½é™…åŒ– |
| **WeatherCard** | æ¸©åº¦ | `live.temperature` | æ•°å­— `18Â°` | âœ… æ— éœ€ç¿»è¯‘ |
| **WeatherCard** | å¤©æ°”æè¿° | `live.weather` | `t.has()` + å›é€€ | âœ… å·²ä¿®å¤ |
| **WeatherCard** | æ¹¿åº¦ | `live.humidity` | `t('humidityValue', { value })` | âœ… å·²å›½é™…åŒ– |
| **WeatherCard** | é£åŠ› | `live.windDirection` | `t('windValue', { direction: t(windDir.*), power })` | âœ… å·²ä¿®å¤ |
| **WeatherCard** | é€‚å®œåº¦æè¿° | `climbing.level` | `` t(`${climbing.level}Desc`) `` | âœ… å·²å›½é™…åŒ– |
| **WeatherCard** | é¢„æŠ¥å¤©æ°” | `forecast.dayWeather` | `getWeatherIcon()` ä»…å–å›¾æ ‡ | âœ… åªæ˜¾ç¤º emoji |
| **WeatherCard** | æ˜ŸæœŸå‡  | `forecast.week` | `t(weekdayKey)` â†’ "Mon" | âœ… å·²å›½é™…åŒ– |
| **WeatherBadge** | å¤©æ°”å›¾æ ‡ | `weather` | `getWeatherIcon()` ä»…å–å›¾æ ‡ | âœ… åªæ˜¾ç¤º emoji |

#### å…·ä½“é—®é¢˜ä»£ç 

**é—®é¢˜ 1: `WeatherStrip` ç¬¬ 89 è¡Œ**

```tsx
// src/components/weather-strip.tsx:89
<span style={{ color: 'var(--theme-on-surface-variant)' }}>
  Â· {live.weather}  {/* â† åˆ‡æ¢è‹±æ–‡åæ˜¾ç¤º "Â· æ™´" */}
</span>
```

**é—®é¢˜ 2: `WeatherCard` ç¬¬ 106 è¡Œ**

```tsx
// src/components/weather-card.tsx:106
<span style={{ color: 'var(--theme-on-surface-variant)' }}>
  {live.weather}  {/* â† åˆ‡æ¢è‹±æ–‡åæ˜¾ç¤º "å¤šäº‘" */}
</span>
```

**é—®é¢˜ 3: `WeatherCard` ç¬¬ 126 è¡Œ**

```tsx
// src/components/weather-card.tsx:126
<span>{t('windValue', { direction: live.windDirection, power: live.windPower })}</span>
// en: "ä¸œåŒ— â‰¤3"  â† direction æœªç¿»è¯‘
// zh: "ä¸œåŒ—é£ â‰¤3çº§"  â† æ­£ç¡®
```

### 2.2 æ”€çˆ¬å»ºè®®æ¨èä¸çœŸå®å¤©æ°”ä¸ä¸€è‡´

**ç»“è®º: å½“å‰æ¶æ„ä¸‹ä¸å­˜åœ¨ä¸ä¸€è‡´é£é™©ï¼Œä½†å­˜åœ¨éšæ‚£ã€‚**

#### ä¸€è‡´æ€§åˆ†æ

æ”€çˆ¬é€‚å®œåº¦ (`ClimbingCondition`) çš„è®¡ç®—é€»è¾‘ï¼š

```
evaluateClimbingCondition(live, { todayHasRain })
  â”œâ”€â”€ æ¶åŠ£å¤©æ°”æ£€æµ‹: BAD_WEATHER_KEYWORDS åŒ¹é… live.weather
  â”œâ”€â”€ æ¸©åº¦è¯„ä¼°: live.temperature ä¸ CLIMBING_THRESHOLDS å¯¹æ¯”
  â”œâ”€â”€ æ¹¿åº¦è¯„ä¼°: live.humidity ä¸ CLIMBING_THRESHOLDS å¯¹æ¯”
  â”œâ”€â”€ é£åŠ›è¯„ä¼°: parseWindPower(live.windPower) ä¸é˜ˆå€¼å¯¹æ¯”
  â””â”€â”€ è¾“å‡º: { level, label, description, factors }
```

**å…³é”®**: `climbing` å­—æ®µæ˜¯åœ¨ API è·¯ç”±ä¸­ä¸ `live` æ•°æ®**åŒæ—¶è®¡ç®—**çš„ (`route.ts:330`)ï¼Œä½¿ç”¨çš„æ˜¯åŒä¸€ä»½ `live` æ•°æ®ã€‚å› æ­¤ï¼š

- ç¼“å­˜å‘½ä¸­æ—¶ï¼Œ`live` å’Œ `climbing` æ¥è‡ªåŒä¸€ä¸ªç¼“å­˜æ¡ç›® â†’ **ä¸€è‡´**
- ç¼“å­˜æœªå‘½ä¸­æ—¶ï¼Œ`climbing` ä»å½“å‰ `live` å®æ—¶è®¡ç®— â†’ **ä¸€è‡´**
- SWR å±‚é¢ï¼Œæ•´ä¸ª `WeatherData` æ˜¯ä¸€ä¸ªåŸå­å¯¹è±¡ â†’ **ä¸€è‡´**

**æ‰€ä»¥å½“å‰ä¸å­˜åœ¨"æ˜¾ç¤ºæ™´å¤©ä½†å»ºè®®ä¸å®œæ”€çˆ¬"è¿™ç§ä¸ä¸€è‡´æƒ…å†µã€‚**

#### æ½œåœ¨éšæ‚£

ä½†å­˜åœ¨ä»¥ä¸‹éšæ‚£å€¼å¾—å…³æ³¨ï¼š

1. **ç¼“å­˜è¿‡æœŸè¾¹ç•Œ**: å¦‚æœå¤©æ°”åœ¨ 1 å°æ—¶å†…å‰§çƒˆå˜åŒ–ï¼ˆå¦‚çªç„¶ä¸‹é›¨ï¼‰ï¼Œç¼“å­˜çš„ `live.weather="æ™´"` å’Œå®é™…å¤©æ°”ä¸ç¬¦ã€‚`climbing` è¯„ä¼°ä¹Ÿæ˜¯åŸºäºæ—§æ•°æ®ã€‚è¿™æ˜¯ç¼“å­˜ç­–ç•¥çš„å›ºæœ‰ç‰¹æ€§ï¼Œä¸æ˜¯ bugï¼Œä½† 1 å°æ—¶çš„ TTL å¯¹å¤©æ°”åœºæ™¯æ˜¯åˆç†çš„ã€‚

2. **`climbing` å¯¹è±¡ä¸­çš„å†—ä½™ä¸­æ–‡å­—æ®µ**:

```typescript
// è¿™äº›å­—æ®µåœ¨ API å“åº”ä¸­å­˜åœ¨ï¼Œä½†å½“å‰ç»„ä»¶æ²¡æœ‰ä½¿ç”¨å®ƒä»¬
climbing: {
  level: "excellent",        // âœ… ç»„ä»¶ç”¨è¿™ä¸ªåš t() æŸ¥æ‰¾
  label: "æä½³",             // âš ï¸ å§‹ç»ˆä¸­æ–‡ï¼Œä½†æœªè¢«æ˜¾ç¤º
  description: "é˜³å…‰æ˜åªš...", // âš ï¸ å§‹ç»ˆä¸­æ–‡ï¼Œä½†æœªè¢«æ˜¾ç¤º
  factors: ["å¤©æ°”: æ™´ âœ“"],   // âš ï¸ å§‹ç»ˆä¸­æ–‡ï¼Œä½†æœªè¢«æ˜¾ç¤º
}
```

å¦‚æœæœªæ¥æœ‰ç»„ä»¶ç›´æ¥ä½¿ç”¨ `climbing.label` æˆ– `climbing.description`ï¼Œä¼šå‡ºç°è¯­è¨€ä¸ä¸€è‡´é—®é¢˜ã€‚

### 2.3 `SUITABILITY_CONFIG` ä¸­çš„å†—ä½™ä¸­æ–‡

`weather-constants.ts` ä¸­çš„ `SUITABILITY_CONFIG` å®šä¹‰äº†ä¸­æ–‡ label å’Œ descriptionï¼š

```typescript
// src/lib/weather-constants.ts:101-131
export const SUITABILITY_CONFIG = {
  excellent: {
    label: 'æä½³',       // â† ä¸­æ–‡
    description: 'æ¸©æ¹¿åº¦é€‚å®œï¼Œå²©é¢å¹²ç‡¥ï¼Œå‡ºå‘å§ï¼',  // â† ä¸­æ–‡
    // ...
  },
}
```

è¿™äº›å€¼è¢« `evaluateClimbingCondition()` ä½¿ç”¨ï¼Œå†™å…¥ API å“åº”çš„ `climbing.label` å’Œ `climbing.description`ã€‚

**å½“å‰çŠ¶æ€**: ç»„ä»¶ä¸æ˜¾ç¤ºè¿™äº›å­—æ®µï¼ˆä½¿ç”¨ `t()` æ›¿ä»£ï¼‰ï¼Œæ‰€ä»¥ä¸å½±å“ç”¨æˆ·ã€‚
**éšæ‚£**: å¦‚æœç¦»çº¿é¡µé¢æˆ–å…¶ä»–æ–°ç»„ä»¶ç›´æ¥ä½¿ç”¨ `climbing.label`ï¼Œä¼šå‡ºç°é—®é¢˜ã€‚

## 3. WEATHER_ICONS æ˜ å°„è¡¨å…¼å®¹æ€§

```typescript
// src/lib/weather-constants.ts
export const WEATHER_ICONS: Record<string, string> = {
  'æ™´': 'â˜€ï¸',
  'å¤šäº‘': 'â˜ï¸',
  'å°é›¨': 'ğŸŒ§ï¸',
  // ... å…¨éƒ¨æ˜¯ä¸­æ–‡ key
}
```

ç”±äºé«˜å¾· API æ°¸è¿œè¿”å›ä¸­æ–‡å¤©æ°”æè¿°ï¼Œ`getWeatherIcon(live.weather)` èƒ½æ­£ç¡®åŒ¹é…ã€‚å³ä½¿ç”¨æˆ·åˆ‡æ¢åˆ°è‹±æ–‡ï¼Œä¼ å…¥çš„ `live.weather` ä»ç„¶æ˜¯ä¸­æ–‡ï¼Œå›¾æ ‡æ˜ å°„ä¸å—å½±å“ã€‚

**ç»“è®º**: WEATHER_ICONS ä¸­æ–‡ key è®¾è®¡æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºæ•°æ®æºä¸å˜ã€‚

## 4. é—®é¢˜ä¸¥é‡æ€§è¯„ä¼°

| é—®é¢˜ | ä¸¥é‡æ€§ | å½±å“èŒƒå›´ | ä¿®å¤éš¾åº¦ |
|------|--------|---------|---------|
| `live.weather` ä¸­æ–‡ç›´æ˜¾ | âœ… å·²ä¿®å¤ | ~~en/fr ç”¨æˆ·çœ‹åˆ°æ··åˆè¯­è¨€~~ | â€” |
| `live.windDirection` ä¸­æ–‡ç›´æ˜¾ | âœ… å·²ä¿®å¤ | ~~en/fr ç”¨æˆ·é£å‘æ˜¾ç¤ºä¸­æ–‡~~ | â€” |
| `climbing` å†—ä½™ä¸­æ–‡å­—æ®µ | ğŸ’¤ ä½ | å½“å‰æ— å¯è§å½±å“ | ä½ (æ”¹ä¸ºåªä¼  `level`) |
| SWR ç¼“å­˜ä¸å« locale | âœ… æ—  | ä¸éœ€è¦ä¿®å¤ | N/A |
| é€‚å®œåº¦ä¸å¤©æ°”ä¸ä¸€è‡´ | âœ… æ—  | å½“å‰ä¸å­˜åœ¨ | N/A |

## 5. ä¿®å¤å»ºè®®

### æ–¹æ¡ˆ A: å®¢æˆ·ç«¯ç¿»è¯‘æ˜ å°„ (æ¨è)

åœ¨ç»„ä»¶å±‚æ·»åŠ å¤©æ°”æè¿°ç¿»è¯‘ï¼Œä¿æŒ API å±‚ä¸å˜ï¼š

```tsx
// messages/en.json ä¸­æ·»åŠ :
"Weather": {
  // ... ç°æœ‰ç¿»è¯‘
  "weatherDesc": {
    "æ™´": "Sunny",
    "å¤šäº‘": "Cloudy",
    "é˜´": "Overcast",
    "å°é›¨": "Light Rain",
    // ...
  },
  "windDir": {
    "åŒ—": "N",
    "ä¸œåŒ—": "NE",
    "ä¸œ": "E",
    // ...
  }
}
```

**ä¼˜ç‚¹**: ä¸æ”¹åŠ¨ API å±‚ï¼Œä¸å½±å“ç¼“å­˜ç­–ç•¥
**ç¼ºç‚¹**: éœ€è¦ç»´æŠ¤å®Œæ•´çš„å¤©æ°”æè¿°æ˜ å°„è¡¨

### æ–¹æ¡ˆ B: ç²¾ç®€ API å“åº”

ä» `WeatherData` ä¸­ç§»é™¤å†—ä½™çš„ä¸­æ–‡å­—æ®µï¼Œ`climbing` åªä¿ç•™ `level`ï¼š

```typescript
// Before
climbing: { level: "excellent", label: "æä½³", description: "...", factors: [...] }

// After
climbing: { level: "excellent" }
```

UI æ–‡æœ¬å…¨éƒ¨ç”±ç»„ä»¶å±‚é€šè¿‡ `t()` ç”Ÿæˆã€‚å‡å°‘ä¼ è¾“ä½“ç§¯ï¼Œæ¶ˆé™¤æœªæ¥è¯¯ç”¨é£é™©ã€‚

### æ–¹æ¡ˆ C: ä¿æŒç°çŠ¶

å¦‚æœäº§å“å®šä½ä»¥ä¸­æ–‡ç”¨æˆ·ä¸ºä¸»ï¼Œè‹±æ–‡/æ³•æ–‡ç”¨æˆ·è¾ƒå°‘ï¼Œå½“å‰çš„æ··åˆè¯­è¨€å±•ç¤ºå¯æ¥å—ã€‚ä¸­æ–‡å¤©æ°”æè¿°æœ¬èº«ä¿¡æ¯å¯†åº¦é«˜ï¼ˆå¦‚ "æ™´" æ¯” "Sunny" æ›´çŸ­ï¼‰ï¼Œåœ¨å°å±ä¸Šæœ‰ç©ºé—´ä¼˜åŠ¿ã€‚

## 6. ç¼“å­˜é…ç½®æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client (Browser)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SWR Cache                            â”‚  â”‚
â”‚  â”‚  Key: /api/weather?adcode=350125      â”‚  â”‚
â”‚  â”‚  Dedup: 60s (åŒ key ä¸é‡å¤è¯·æ±‚)       â”‚  â”‚
â”‚  â”‚  revalidateOnFocus: false             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  HTTP Cache (Browser)                 â”‚  â”‚
â”‚  â”‚  Cache-Control: public, max-age=3600  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ fetch
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Server (/api/weather)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Memory Cache (Map)                   â”‚  â”‚
â”‚  â”‚  Key: adcode                          â”‚  â”‚
â”‚  â”‚  TTL: 1 hour (API_CACHE.WEATHER_TTL)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  é«˜å¾· API (å®å†µ + é¢„æŠ¥)               â”‚  â”‚
â”‚  â”‚  Always returns Chinese text          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç»“è®º**: SWR ç¼“å­˜ç­–ç•¥æœ¬èº«æ˜¯åˆç†çš„ã€‚è¯­è¨€é—®é¢˜çš„æ ¹æºæ˜¯é«˜å¾· API åªè¿”å›ä¸­æ–‡ï¼Œè€Œéƒ¨åˆ†ç»„ä»¶ç›´æ¥å±•ç¤ºäº†è¿™äº›ä¸­æ–‡æ–‡æœ¬ã€‚ä¿®å¤åº”åœ¨ç»„ä»¶æ¸²æŸ“å±‚è¿›è¡Œï¼Œè€Œéç¼“å­˜å±‚ã€‚

## 7. ä¿®å¤è®°å½•

> ä¿®å¤æ—¥æœŸ: 2026-02-12 | é‡‡ç”¨æ–¹æ¡ˆ A (å®¢æˆ·ç«¯ç¿»è¯‘æ˜ å°„)

### å˜æ›´å†…å®¹

åœ¨ `messages/{zh,en,fr}.json` çš„ `Weather` å‘½åç©ºé—´ä¸‹æ–°å¢ï¼š
- `weatherDesc`: 17 ç§å¸¸è§å¤©æ°”æè¿°çš„ç¿»è¯‘ (æ™´/å¤šäº‘/é˜´/å°é›¨/ä¸­é›¨/å¤§é›¨ç­‰)
- `windDir`: 8 ä¸ªæ–¹ä½çš„ç¿»è¯‘ (åŒ—/ä¸œåŒ—/ä¸œ/ä¸œå—/å—/è¥¿å—/è¥¿/è¥¿åŒ—)

ç»„ä»¶å±‚ä½¿ç”¨ `t.has()` å®‰å…¨å›é€€ï¼Œæœªæ”¶å½•çš„ç½•è§å¤©æ°”æè¿°å›é€€æ˜¾ç¤ºåŸå§‹ä¸­æ–‡ï¼š
```tsx
{t.has(`weatherDesc.${live.weather}`) ? t(`weatherDesc.${live.weather}`) : live.weather}
```

### ä¿®æ”¹æ–‡ä»¶
- `messages/zh.json` / `en.json` / `fr.json` â€” æ–°å¢ç¿»è¯‘æ¡ç›®
- `src/components/weather-strip.tsx` â€” `live.weather` æ”¹ä¸ºç¿»è¯‘æŸ¥æ‰¾
- `src/components/weather-card.tsx` â€” `live.weather` + `live.windDirection` æ”¹ä¸ºç¿»è¯‘æŸ¥æ‰¾
- `src/test/setup.tsx` â€” mock `useTranslations` è¡¥å…… `has()` æ–¹æ³•
